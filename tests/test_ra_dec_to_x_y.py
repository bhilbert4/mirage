#! /usr/bin/env python

"""Test the locations of sources in various apertures using RADec_To_XY

Note that the truth values in this case were calculated using the
distortion reference files, which are not part of the repo and not
available to Travis

Values were calculated using run_all_apertures.py in
the test_mirage_subarray_source_location subdirectory
"""

import numpy as np
import pysiaf

from mirage.seed_image import catalog_seed_image
from mirage.utils import siaf_interface

reference_file_values = {
'nircam_NRCA1_FULL': ([1023.4999999999795, 1013.6655281786176, 1003.8299720773244, 984.1556194679087, 949.7151712000253, 846.3161706401412, 530.5110720514681, 35.22917941992637], [1023.4999999998547, 1033.3109865349254, 1043.1226898691314, 1062.7482342577243, 1097.099729409338, 1200.2048432008405, 1514.8651233860598, 2007.6245129372749]),
'nircam_NRCA2_FULL': ([1023.5000000001924, 1013.5963968853717, 1003.6919523864897, 983.8805562715387, 949.2026590968576, 845.1099529899086, 527.3780604465746, 29.7639241736141], [1023.4999999996598, 1033.5071104502574, 1043.514450153725, 1063.5297995433727, 1098.5587169469636, 1203.6593720689186, 1524.0438340337842, 2024.5270119054699]),
'nircam_NRCA3_FULL': ([1023.5000000000091, 1013.8545390986018, 1004.2075267718387, 984.9088620996482, 951.121385898905, 849.6471994917503, 539.3930480289398, 51.80116507360219], [1023.4999999999422, 1033.3612380823884, 1043.2234600973418, 1062.9508405146864, 1097.4830974688145, 1201.149730317103, 1517.6951539208112, 2013.9237011055468]),
'nircam_NRCA4_FULL': ([1023.5000000000653, 1013.6945302466661, 1003.8877230998094, 984.2701087010972, 949.9265127822986, 846.7993873574419, 531.6476884995619, 36.83329082925968], [1023.4999999997392, 1033.5203360446187, 1043.5411782478593, 1063.5843676323002, 1098.6647068976454, 1203.9407171663788, 1525.0688322211913, 2027.4542323737992]),
'nircam_NRCA5_FULL': ([1023.4999999999443, 1018.663441733194, 1013.8263230330571, 1004.1504123432619, 987.2122420045278, 936.3578450335687, 781.025385512401, 537.406641558103], [1023.4999999998945, 1028.4021845736197, 1033.304636356919, 1043.1103329363507, 1060.272801221799, 1111.7784427554882, 1268.8938350062472, 1514.6812247906028]),
'nircam_NRCB1_FULL': ([1023.500000000018, 1013.6948850432896, 1003.8885247270736, 984.2720805122075, 949.9314217804308, 846.8199409470831, 531.7802843441991, 37.34285966404832], [1023.4999999997619, 1033.6276952352603, 1043.7551424248738, 1064.0092784575256, 1099.4515091484152, 1205.7576444620584, 1529.5094156206007, 2034.4277410420932]),
'nircam_NRCB2_FULL': ([1023.5000000000443, 1013.9079041179855, 1004.3143570626255, 985.1229240774794, 951.5240714704902, 850.6231841973554, 542.1857747586639, 57.64615521255564], [1023.499999999698, 1033.5384297274536, 1043.5771197022832, 1063.6552640146838, 1098.7943842290495, 1204.2282634296018, 1525.6638373945584, 2028.0271050930655]),
'nircam_NRCB3_FULL': ([1023.4999999998893, 1013.6005948619423, 1003.7004710907806, 983.8980855513535, 949.2371457419414, 845.2044803714037, 527.7430824671337, 30.83570617397322], [1023.4999999997899, 1033.4444492530934, 1043.3883640587853, 1063.2745718858598, 1098.0701352939984, 1202.4144852898269, 1519.971691193381, 2014.4481486470654]),
'nircam_NRCB4_FULL': ([1023.4999999999427, 1013.7491987483623, 1003.9974323064408, 984.491016370561, 950.3456042463469, 847.8404798347053, 534.8409924489365, 44.191310900481426], [1023.4999999998047, 1033.3460900549824, 1043.1921658128572, 1062.8842613943295, 1097.3451812764358, 1200.7247757904256, 1515.7230132056352, 2007.5023162619877]),
'nircam_NRCB5_FULL': ([1023.49999999992, 1018.6774324793421, 1013.8543325748249, 1004.206543565853, 987.3178556330668, 936.6139569834988, 781.7589292429454, 538.9414559464672], [1023.4999999999811, 1028.4139034541356, 1033.327728748647, 1043.1551361836446, 1060.3522738116842, 1111.936530707782, 1269.0565328529135, 1514.14286718726]),
'nircam_NRCA1_SUB160': ([79.47575618716223, 69.66838521669524, 59.859819901379524, 40.239117670869746, 5.891489648299512, -97.23731082921086, -412.2985763204274, -906.6825875955176], [79.49770829268164, 89.42717067092485, 99.3572632123387, 119.21932657802904, 153.98389988634926, 258.32194748623624, 576.682042317022, 1075.0470216746862]),
'nircam_NRCA2_SUB160': ([79.54427460493184, 69.73797864716471, 59.93051324251746, 40.312085727761314, 5.968679873858719, -97.14558613350846, -412.14438266460775, -906.367667339426], [79.46916662131787, 89.43758570666557, 99.40657975846352, 119.34628025668985, 154.24618466124411, 258.98611227625497, 578.5315815910187, 1078.6171159244657]),
'nircam_NRCA3_SUB160': ([79.53384189371911, 69.75304155756658, 59.970985216232975, 40.40311577506327, 6.147350037403157, -96.71043319379987, -410.98910346460866, -904.2926377518556], [79.46730385712931, 89.40630741133214, 99.34597657505446, 119.22729957100319, 154.02591888620645, 258.46872360180987, 577.172865188596, 1076.156994907738]),
'nircam_NRCA4_SUB160': ([79.46748477090841, 69.62126700454337, 59.77381753214479, 40.075234900408304, 5.590956500564857, -97.95054476820314, -414.2952250155022, -910.7649360197288], [79.48185103382605, 89.39647205453844, 99.3116931837884, 119.14392350391347, 153.85599919490335, 258.03433334349677, 575.8868221107638, 1073.3925350639697]),
'nircam_NRCA5_SUB160': ([79.4999999999443, 74.66344173319396, 69.82632303305707, 60.150412343261905, 43.21224200452775, -7.642154966431349, -162.97461448759896, -406.59335844189695], [79.4999999998945, 84.4021845736197, 89.30463635691899, 99.11033293635069, 116.272801221799, 167.7784427554882, 324.8938350062472, 570.6812247906028]),
'nircam_NRCB1_SUB160': ([79.4532620894762, 69.67493772374814, 59.8954864825638, 40.33321501980254, 6.088491982415235, -96.7266026724144, -410.78524590969914, -903.4606741515245], [79.46871417023215, 89.49034522439922, 99.51183764043162, 119.55439372643059, 154.62742430305116, 259.8342339616647, 580.3164955619291, 1080.401054693653]),
'nircam_NRCB2_SUB160': ([79.52011851468558, 69.80409300507927, 60.086917944338325, 40.649130624250006, 6.6220348843986585, -95.54188148475464, -407.63265149307904, -897.2923539804892], [79.5025763962999, 89.54708862486746, 99.59152767127443, 119.68017349241381, 154.8344921392354, 260.2900030346782, 581.575855208037, 1083.0639732446625]),
'nircam_NRCB3_SUB160': ([79.53071096491294, 69.7173882279842, 59.90300532400806, 40.27107099064665, 5.905082909519251, -97.26884074653162, -412.37357790206306, -906.5256268605472], [79.48294600906763, 89.46059268875251, 99.43806334491399, 119.3924636376496, 154.31086065643592, 259.0509961303743, 578.0845834058081, 1075.817542315459]),
'nircam_NRCB4_SUB160': ([79.46468613392221, 69.67420159751464, 59.88262984151879, 40.296236353169206, 6.0096818183806135, -96.92798327336368, -411.33279140966647, -904.4626556997899], [79.46783592599695, 89.43232675314403, 99.39670377812081, 119.32510376437904, 154.1986017136487, 258.80866963007065, 577.4900881013591, 1074.819680208877]),
'nircam_NRCB5_SUB160': ([79.49895642478657, 74.67516141590454, 69.85084488776408, 60.20065524817926, 43.307870986789, -7.40751346484501, -162.28998565564984, -405.12619639409616], [79.5003130106378, 84.41141524361979, 89.32243455584103, 99.14421574113385, 116.331461580932, 167.88569221761668, 324.9108892412696, 569.8384858788472]),
'nircam_NRCA1_SUB320': ([159.4755809122248, 149.66550269544132, 139.85423867080863, 120.22816466854647, 85.87121852762448, -17.28490226659551, -332.4234195650929, -826.9087414222194], [159.49570717062488, 169.41549949936052, 179.33592894477988, 199.17868699079008, 233.9095430227303, 338.14695245128405, 656.2051752444349, 1154.113986493574]),
'nircam_NRCA4_SUB320': ([159.46968884018304, 149.62652778533163, 139.7821265402123, 120.08961491634295, 85.61587916630651, -17.894617350652425, -334.1506049926754, -830.4998152685318], [159.48453184370885, 169.40849981095778, 179.33306080386717, 199.18394954871042, 233.92860884241384, 338.2041636355334, 656.347844274653, 1154.2915637756041]),
'nircam_NRCB1_SUB320': ([159.455887226384, 149.67491958359255, 139.8928155346266, 120.32520988830652, 86.07106048842797, -16.773010581723156, -330.9264018357121, -823.7696102770046], [159.47058712315595, 169.50159253744653, 179.5324509508647, 199.59371387780948, 234.69940037509514, 340.0035517868291, 660.7764567085815, 1161.2951845403175]),
'nircam_NRCB3_SUB320': ([159.52834473176904, 149.7065370166954, 139.88369359409307, 120.23491183733404, 85.8396782311288, -17.420141865722144, -332.76873053460554, -827.2399437908348], [159.48583354195523, 169.46188869786272, 179.4377415727895, 199.38882733358992, 234.30116947268323, 339.02117418908506, 657.9744147913896, 1155.5173429205915]),
'nircam_NRCB5_SUB320': ([159.49895642478657, 154.67516141590454, 149.85084488776408, 140.20065524817926, 123.307870986789, 72.59248653515499, -82.28998565564984, -325.12619639409616], [159.5003130106378, 164.41141524361979, 169.32243455584103, 179.14421574113385, 196.331461580932, 247.88569221761668, 404.9108892412696, 649.8384858788472]),
'nircam_NRCA2_SUB640': ([319.5357597688926, 309.7018014527614, 299.8667464147625, 280.19335858576915, 245.7544788658479, 142.35927399296452, -173.44216952245984, -668.7346287977407], [319.4754272890483, 329.4566775209786, 339.43842521183365, 359.40339973312564, 394.34678132399324, 499.211312992147, 819.0798866265718, 1319.4764456760495]),
'nircam_NRCA4_SUB640': ([319.4750088198805, 309.6381763169139, 299.8000865548911, 280.120146731261, 245.6682476644512, 142.22201178678563, -173.84968781301768, -669.946554891837], [319.489708253864, 329.43216564790794, 339.37520158371024, 359.2629966258095, 394.0721013598346, 498.53990422876984, 817.2589533215464, 1316.0662811184827]),
'nircam_NRCB1_SUB640': ([319.4625716898329, 309.6765189896281, 299.88931069139164, 280.311439046107, 246.0391400363261, 143.1392202558875, -171.19723251803566, -664.365452576706], [319.4753202450729, 329.52487119685793, 339.5742580835023, 359.67252660505085, 394.8428072888514, 500.3394596588839, 821.6866504909221, 1323.0612660511524]),
'nircam_NRCB3_SUB640': ([319.5228772285691, 309.68470739049735, 299.8455523759053, 280.16429964740064, 245.7127335383732, 142.28773879931464, -173.52667676309147, -668.5945502069615], [319.4912854559093, 329.4635301830647, 339.43551871164254, 359.3787134815449, 394.27672272491304, 498.94966917902775, 817.7199361473196, 1314.8409152736315]),
'nircam_NRCB5_SUB640': ([319.49895642478657, 314.67516141590454, 309.8508448877641, 300.20065524817926, 283.307870986789, 232.592486535155, 77.71001434435016, -165.12619639409616], [319.5003130106378, 324.4114152436198, 329.322434555841, 339.14421574113385, 356.331461580932, 407.8856922176167, 564.9108892412696, 809.8384858788472]),
'nircam_NRCA5_GRISM256_F322W2': ([1579.9842856588948, 1575.2529881667815, 1570.520817240277, 1561.0538653483418, 1544.478378817734, 1494.6893635775093, 1342.3978285613769, 1102.9157438677146], [34.01474027233371, 38.81582781047655, 43.61759230144867, 53.22314041201264, 70.03926691506695, 120.53552724625627, 274.8431928849436, 517.0366819055537]),
'nircam_NRCA5_GRISM128_F356W': ([1579.9842856588948, 1575.2529881667815, 1570.520817240277, 1561.0538653483418, 1544.478378817734, 1494.6893635775093, 1342.3978285613769, 1102.9157438677146], [34.01474027233371, 38.81582781047655, 43.61759230144867, 53.22314041201264, 70.03926691506695, 120.53552724625627, 274.8431928849436, 517.0366819055537]),
'nircam_NRCA3_FP1_SUB64': ([31.02344702831715, 21.302428840347375, 11.580027050015701, -7.868915457443904, -41.91778225344922, -144.16416768264799, -456.66545863887154, -947.4624565799784], [31.976490588320985, 41.86958120977715, 51.76349330310359, 71.55376890578464, 106.19454872905817, 210.1751782440149, 527.5752011154641, 1024.8465425403574]),
'nircam_NRCA3_SUB160P': ([79.49562954080011, 70.02282971256227, 60.548023465694314, 41.59241563158457, 8.40099025220752, -91.31696426236113, -396.4921584138199, -876.8650791275074], [79.5196007322752, 89.2647184487555, 99.01130392030052, 118.50885274529685, 152.64347789117903, 255.15120426543558, 568.4564497267, 1060.390127714378]),
'nircam_NRCA3_SUB400P': ([199.48858288051815, 189.991031578591, 180.49154647544765, 161.4867971726444, 128.2100597078006, 28.241251201640353, -277.6552099740343, -759.0443534775528], [199.52314394731002, 209.28588800594082, 219.05002318845277, 238.58244319345465, 272.77736914950435, 375.4606275908001, 689.2550286918669, 1181.8351424302386]),
'nircam_NRCB1_SUB400P': ([199.50623126068695, 189.68660072821967, 179.86559695876826, 160.21948394250967, 125.8256885244814, 22.545673685560814, -293.08798878782636, -788.6754101582678], [199.4993760803727, 209.70992690563003, 219.92009989136636, 240.3392958401364, 276.0691126758279, 383.22808578338436, 709.4806290089905, 1217.965343349651]),
'nircam_NRCB5_SUB400P': ([282.91826525959686, 278.0766926910833, 273.2344322619597, 263.54785698798264, 246.5898067574385, 195.66658399590915, 40.04186593748, -204.27107908921403], [313.35868536818384, 318.36238992855283, 323.3658480393906, 333.37201452668023, 350.8803461711698, 403.3855295550702, 563.1900239930137, 812.06724066792]),
'nircam_NRCB5_TAPSIMG32': ([15.518761014653592, 10.693369368201047, 5.867241323895087, -3.7872146571089615, -20.68952223183942, -71.44906758367733, -226.60780346697948, -470.29442419794555], [15.504655607613586, 20.511820248502772, 25.518799628047418, 35.532192544385, 53.0537622132656, 105.60321547025842, 265.5859974269324, 514.8828708850988]),
'niriss_NIS_CEN': ([1023.5204275218792, 1018.977169577552, 1014.433934416907, 1005.3475322947195, 989.4465464671883, 941.7452304319153, 796.3839932991559, 569.2892101280329], [1023.5160465457657, 1028.2896434108445, 1033.0631900223589, 1042.6101339960312, 1059.3168151884859, 1109.433424218175, 1262.1428841349511, 1500.7078570690007]),
'niriss_NIS_AMI1': ([35.2477098608756, 30.703609922818487, 26.159522269095987, 17.071384901636975, 1.1672717739475047, -46.5439967470935, -191.93761429872484, -419.0695898138496], [39.6629287831823, 44.44052800989613, 49.21808731391637, 58.77308433324673, 75.49392972778122, 125.65324984546146, 278.48621247829243, 517.1714114245582]),
'niriss_NIS_AMI2': ([7.417528442626917, 2.8734965583139456, -1.6705217041062497, -10.758516338304844, -26.66236733039659, -74.37276117638157, -219.76305762784136, -446.8888452333499], [56.93785959995158, 61.715211075403545, 66.49252088331873, 76.04701376065562, 92.76696082807334, 142.92347150143354, 295.74703438057014, 534.416362819196]),
'niriss_NIS_AMI3': ([7.0929332835266905, 2.5488977384929967, -1.9951249701730376, -11.083130815304912, -26.987008665218696, -74.69753461825098, -220.08861083847523, -447.21614999079463], [23.99248644649244, 28.76983324865968, 33.547141159550804, 43.10163846206004, 59.82161907243263, 109.97841666474409, 262.8042922971375, 501.47984179298044]),
'niriss_NIS_AMI4': ([49.07926137682716, 44.53513044868373, 39.991010889653126, 30.902807006410285, 14.99856900986606, -32.71313477413662, -178.10853375699844, -405.2440200562304], [22.539528606318317, 27.317245519050516, 32.0949241568455, 41.65016471577552, 58.3714515689368, 108.53220570094494, 261.3703688934042, 500.06508044586235]),
'niriss_NIS_AMITA': ([22.95759728221651, 18.413514027895644, 13.86944489328198, 4.781349980476762, -11.122671939886004, -58.8335464575016, -204.22508257927325, -431.3525638342976], [31.602096588545578, 36.37963097850202, 41.157119673881425, 50.71195840286964, 67.43247327962882, 117.59041701856427, 270.41625761586073, 509.0853403027594]),
'niriss_NIS_WFSS64R': ([29.743854548679337, 25.198001449054118, 20.652142770176624, 11.560410282112343, -4.350161859841364, -52.08203590517246, -197.54845990169065, -424.8161434972162], [783.6137867242794, 788.3969092751007, 793.1799751712933, 802.7459367378171, 819.4858221787879, 869.7012857784752, 1022.7003822399082, 1261.654828723343]),
'niriss_NIS_WFSS64C': ([805.077502003052, 800.5344275888807, 795.9913470018597, 786.9051656625875, 771.0042749128345, 723.3008732642784, 577.9074507644339, 350.66089999083096], [33.88616661400101, 38.66674850027425, 43.44742747698956, 53.009081740513466, 69.74295383320077, 119.95253788343643, 273.0600358541524, 512.6484283241225]),
'niriss_NIS_WFSS128R': ([61.71413054702998, 57.16827892189826, 52.62242337816565, 43.53070209428256, 27.62016513758408, -20.111489122134117, -165.5763122351375, -392.83944993567707], [784.0230002659605, 788.8058577129614, 793.5886579352879, 803.1540864770354, 819.8930339144758, 870.1056469286804, 1023.0958029072835, 1262.0360349360783]),
'niriss_NIS_SUB64': ([42.33433740624832, 37.7882469534336, 33.24217154231087, 24.150066035801274, 8.23902765919388, -39.49295933919848, -184.95152389550185, -412.2045745205862], [21.66302987159588, 26.45185570103945, 31.240740270243577, 40.818689421502086, 57.5806979573706, 107.87167048683978, 261.19601628382725, 501.0095209085316]),
'niriss_NIS_SUB128': ([73.93310033148532, 69.38707844347482, 64.84107198015863, 55.74910550731033, 39.83831403275394, -7.892905910336822, -153.34891797476462, -380.59750841294886], [53.93898386858518, 58.726901621145316, 63.51487268989945, 73.09097849541695, 89.84970835393483, 140.13043427245339, 293.41956203776544, 533.1648467943951]),
'niriss_NIS_SUB256': ([137.14708238413823, 132.60120463441763, 128.05534304867297, 118.96366852693609, 103.05339489599396, 55.32377921981379, -90.12693218719869, -317.36635106926315], [118.51135695250127, 123.29756637195692, 128.08381864174794, 137.65645530466327, 154.4090121910001, 204.67042607578128, 357.8929769887163, 597.5086338949673]),
'niriss_NIS_SUBSTRIP256': ([1956.249313637183, 1951.7031895422501, 1947.1570737139555, 1938.0648679040567, 1922.1535959949044, 1874.4205493519028, 1728.9576645043185, 1501.7080983876983], [1187.6922587452116, 1192.4737475601848, 1197.2551927410261, 1206.8179533411692, 1223.552374222077, 1273.752628709843, 1426.719987160013, 1665.6910521637271]),
'fgs_FGS1_FULL': ([1023.5000000000014, 1018.976640562942, 1014.4532613209619, 1005.4064491793131, 989.5743857912253, 942.0776743440738, 797.335974969308, 571.2987407329019], [1023.4999999999594, 1027.960821616418, 1032.4221497134938, 1041.3463195533511, 1056.968442837173, 1103.8710983597227, 1247.1331297833171, 1471.8551277443896]),
'fgs_FGS2_FULL': ([1023.4999999999518, 1019.0552710766792, 1014.6099539879696, 1005.7175610433957, 990.1502605483206, 943.406058896556, 800.5711324573884, 576.3474447442229], [1023.4999999998138, 1027.883286903746, 1032.2673672352437, 1041.037902260723, 1056.3939254395157, 1102.5193510916517, 1243.6072929394286, 1465.516962330365]),
'fgs_FGS1_SUB128LL': ([63.50046169829261, 58.948524678617105, 54.39646597172441, 45.29198925391256, 29.35803224495794, -18.451848315913594, -164.2172452801292, -392.06284823601777], [63.48703991495631, 68.01998379509178, 72.553325490014, 81.62119654951766, 97.49375124580229, 145.13971769430464, 290.5932769681326, 518.5174045903777]),
'fgs_FGS1_SUB128DIAG': ([63.50186035863635, 58.961320908593734, 54.420710613844676, 45.339283247615185, 29.44615196122959, -18.237514554133213, -163.5836875219543, -390.6700344805304], [63.501137721855685, 68.00117461444984, 72.50166312592364, 81.5039892207601, 97.26235800174572, 144.56971951650894, 289.0278811945841, 515.5066854906131]),
'fgs_FGS1_SUB128CNTR': ([63.500000000001364, 58.97664056294195, 54.45326132096193, 45.406449179313086, 29.574385791225268, -17.922325655926215, -162.66402503069196, -388.70125926709807], [63.499999999959414, 67.96082161641789, 72.42214971349381, 81.34631955335112, 96.96844283717292, 143.87109835972274, 287.13312978331714, 511.8551277443896]),
'fgs_FGS2_SUB128LL': ([63.50368092365807, 59.224784690233264, 54.9449844749513, 46.3826777899294, 31.38998819219023, -13.653599521017895, -151.52061589519894, -368.6304534137189], [63.51277603293738, 67.68218346844571, 71.85271472254885, 80.19714273738339, 94.81065842093108, 138.7328407204128, 273.3306856381889, 485.77608177215507]),
'fgs_FGS2_SUB128DIAG': ([63.49848071909287, 59.12704347412864, 54.75486155045746, 46.00826937760053, 30.69461363330629, -15.30016057536568, -155.95762486550666, -377.10041681511393], [63.500672087887324, 67.78746013928571, 72.0752047201147, 80.65355753566769, 95.674831584294, 140.8079955622859, 278.9827537076069, 496.6745387517933]),
'fgs_FGS2_SUB128CNTR': ([63.4999999999518, 59.05527107667922, 54.60995398796956, 45.717561043395676, 30.150260548320603, -16.593941103443967, -159.42886754261156, -383.6525552557771], [63.49999999981378, 67.88328690374601, 72.26736723524368, 81.03790226072306, 96.39392543951567, 142.51935109165174, 283.6072929394286, 505.516962330365]),
'fgs_FGS1_FP1MIMF': ([1012.0001800830843, 1007.477732813428, 1002.9552650484208, 993.9102737893066, 978.0813902994786, 930.5941677919543, 785.8809174142692, 559.8867181795149], [994.0002605345319, 998.4582284211282, 1002.9167080713819, 1011.8351968657491, 1027.447429161076, 1074.3207998739524, 1217.4971711134692, 1442.0961299255214]),
'fgs_FGS2_FP1MIMF': ([1010.0001598632778, 1005.5539706420655, 1001.1071969629214, 992.2119019607345, 976.6395585535005, 929.8805007359132, 787.00282115075, 562.7199434403801], [1030.999993723248, 1035.3849113335782, 1039.7706191787518, 1048.5443996538502, 1063.9060716407428, 1110.0482090709004, 1251.1849114237452, 1473.1642268001497])
}





nircam_apertures = []
niriss_apertures = []
fgs_apertures = []
for key in reference_file_values:
    instrument = key.split('_')[0]
    detector = key.split('_')[1]
    aperture = key.split('{}_'.format(instrument))[1]
    if instrument == 'nircam':
        nircam_apertures.append(aperture)
    elif instrument == 'niriss':
        niriss_apertures.append(aperture)
    elif instrument == 'fgs':
        fgs_apertures.append(aperture)


def test_locations():
    """Test RA, Dec to x,y translation. This function does the
    translation using pysiaf. This is the truth case we will
    compare against the version translated via distortion
    reference file
    """
    # RA, Dec of pointing
    c = catalog_seed_image.Catalog_seed()

    pointing_ra = 12.0
    pointing_dec = 12.0
    rotation = 0.0

    ra_list = []
    dec_list = []
    delta_pix = np.array([0, 10, 20, 40, 75, 180, 500, 1000])
    delta_deg = delta_pix * 0.031 / 3600.
    for delta in delta_deg:
        ra_entry = pointing_ra + delta
        dec_entry = pointing_dec + delta
        ra_list.append(ra_entry)
        dec_list.append(dec_entry)

    xy_vals = {}
    instrument_list = ['nircam', 'niriss', 'fgs']
    for instrument, aperture_list in zip(instrument_list, [nircam_apertures, niriss_apertures, fgs_apertures]):
        siaf = siaf_interface.get_instance(instrument)
        for aperture in aperture_list:
            print('instrument: ', instrument)
            print('aperture: ', aperture)
            c.local_roll, c.attitude_matrix, c.ffsize, \
                c.subarray_bounds = siaf_interface.get_siaf_information(siaf,
                                                                        aperture,
                                                                        pointing_ra, pointing_dec,
                                                                        rotation)
            c.coord_transform = None
            c.siaf = siaf[aperture]

            xvals = []
            yvals = []
            for ra, dec in zip(ra_list, dec_list):
                x, y = c.RADecToXY_astrometric(ra, dec)
                ra_check, dec_check, ra_str, dec_str = c.XYToRADec(x, y)
                assert np.isclose(ra, ra_check, rtol=0, atol=5e-6)
                assert np.isclose(dec, dec_check, rtol=0, atol=5e-6)
                xvals.append(x)
                yvals.append(y)
            xy_vals['{}_{}'.format(instrument, aperture)] = (xvals, yvals)
            assert (xvals, yvals) == reference_file_values['{}_{}'.format(instrument, aperture)]



